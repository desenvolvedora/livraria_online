build_settings:
    clone_depth: 1
    verbose: true
    ignore:
        - "vendor"
        - "tests"
        - "Dockerfile"
        - "Dockerfile.save"

setup:
    shell: 
        - "mv .htaccess.dist .htaccess"
        - "cd application/config && mv config.php.dist config.php"
        - "cd tests && mv bootstrap.php.dist bootstrap.php"



test:
    php_unit:
        config:
            - "phpunit.xml"
        directory:
            - "tests/"
        coverage: "--coverage-html"

    php_loc:

    # php_code_sniffer:
    #     standard: "PSR2"
    #     allowed_errors: -1
    #     allowed_warnings: -1
    #     ignore:
    #         - "public"
    #         - "tests"
    #         - "vendor"
    #         - "Dockerfile"
    #         - "Dockerfile.save"
    #         - "deployer.phar"
    #         - "docker-compose.yml"
    #         - "phpci.yml.dist"
    #         - "phpci.yml.save"
    #         - "phpunit.xml"
    
    php_cpd:
        standard: "PSR2"
        path: "application"
        ignore:

    php_mess_detector:
        allow_failures: true

    codeception:
        config: "codeception.yml"
        path: "tests/output/"
        args: "report.xml --no-ansi --coverage-html"

failure:
    # email:
    #     committer: true

success:
    shell: 
        - "cd %BUILD_PATH% && dep executa_implantacao producao"
